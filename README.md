This repository documents my complete work on implementing custom IEC60958 (S/PDIF) audio frame handling on the i.MX8MP platform, covering both the application-level encoding/decoding logic and the low-level XCVR/SDMA integration within the MCUXpresso SDK. The core goal of this project is to bypass the default ALSA framing path and gain direct control over how audio samples are packaged, transferred, and transmitted through the SPDIF transmitter.

The project consists of two main parts. The first is a standalone user-space application capable of converting raw PCM audio into valid IEC60958 frames and also extracting PCM samples back from IEC60958 streams. This includes my custom implementation for assembling 192-frame blocks, embedding channel status bits, generating preambles, and forming subframe structures fully aligned with the IEC60958-1 specification. The decoder portion is able to parse subframes, validate preambles, read auxiliary bits, extract channel status blocks, and reconstruct the original PCM payload. This application is the tool I use to generate 48-second IEC60958 frame data, store it to binary files, and prepare it for direct hardware transmission.

The second part of the project involves my modifications to the MCUXpresso SDK for the i.MX8MP, where I created a minimal XCVR driver that exposes the transmitter at a very low level. Instead of relying on the standard audio stack, I enabled direct control of the XCVR registers and FIFO so that raw frames produced by my application can be pushed directly into the hardware. This work also includes experimentation with SDMA-based continuous transmission. I explored how the fsl_xcvr driver interacts with SDMA, how descriptor structures are prepared, how the XCVR requests data from the FIFO, and how the hardware signals transfer events. I implemented custom handling for transmitting my pre-generated IEC60958 frame buffer through SDMA without ALSA, ensuring the XCVR sees a continuous stream without glitches or manual retriggering. As part of this, I modified functions in fsl_xcvr.c, fsl_sdma.c, and the SDMA script headers to monitor descriptors, debug Done-bit behavior, and understand how virtual buffer addresses propagate through the DMA pipeline.

Across this work, I documented register behavior, interrupt dependencies, and the effect of enabling individual XCVR interrupts on data flow. I also validated transmission by observing increasing frame counters, FIFO event flags, and consistent movement inside the SDMA callback. The result is a working environment where I can generate IEC60958 frames, transmit them through the XCVR hardware on i.MX8MP, and analyze exactly how the platform handles each part of the pipeline.

This repository therefore serves both as a reference for IEC60958 frame construction/parsing and as a practical low-level exploration of the i.MX8MP XCVR + SDMA architecture. It demonstrates how to bridge user-generated audio frames with bare-metal hardware transmission, bypassing the default Linux audio subsystem and enabling complete control over the SPDIF signal at the frame level.
